<head>
  <style>
    body { 
      background-color: white; 
      font-family: "arial"; 
      text-align: center;
      border-radius: 5;
      color: black;
    }
  </style>
  <title>Pony</title>
</head>

<body>
  <main>
    <h1>Pony</h1>
    <br>
    <div id="drafts"></div>
    <br>
    <div id="threads"></div>
    <br>
    <script>
    

/*function post(tag, data) {
    fetch('/apps/pony', {
        method: 'POST',
        body: JSON.stringify({[tag]: data})
    })
    location.reload()
}*/

getState()
    .then((state) => renderPage(state))

async function getState() {
    const response = await fetch('/apps/pony/state')
    return response.json()
}


/*function postNewPage()
{
    post("new-page", [document.getElementById('nameBox').value, document.getElementById('htmlBox').value]);
}

function postDeletePage()
{
    var page = event.currentTarget.myPage;
    post("delete-page", page);
}*/

function renderPage(state)
{

    //Drafts
    const drafts = document.getElementById("drafts");

    if(state[1].length > 0)
    {
      const headerDr = document.createElement("h3");
      headerDr.textContent = "Drafts";
      drafts.appendChild(headerDr);
    }

    for(var i = 0; i < state[1].length; i++)
    {
        const draft = document.createElement("a");
        draft.textContent = state[1][i][0];
        draft.setAttribute('href', "pony/drafts/" + state[1][i][0]);
        drafts.appendChild(draft);

        drafts.appendChild(document.createElement("br"));
        drafts.appendChild(document.createElement("br"));
    }

    //Threads
    const threads = document.getElementById("threads");

    if(state[0].length > 0)
    {
      const headerTh = document.createElement("h3");
      headerTh.textContent = "Threads";
      threads.appendChild(headerTh);
    }

    for(var i = 0; i < state[0].length; i++)
    {
        const thread = document.createElement("a");
        thread.textContent = state[0][i][1];
        thread.setAttribute('href', "pony/" + state[0][i][0]);
        threads.appendChild(thread);

        threads.appendChild(document.createElement("br"));
        threads.appendChild(document.createElement("br"));
    }
}

</script>
</main>